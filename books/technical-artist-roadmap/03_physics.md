---
title: 基礎知識：物理
---
CGにおいての物理は、単なる物理演算シミュレーションだけではなく、簡略化した運動の計算や、色や光の計算など応用範囲は様々です。前章の数学の知識を使いつつ、現実世界で起きている現象をシンプルに記述できるので、より実践的な単元になります。

注）詳細な説明よりも、重要なポイントの概要を紹介することを目的としています。
正しい説明やわかりやすい解説などは、他の記事を参照ください。

## 運動

![](https://storage.googleapis.com/zenn-user-upload/8b7be4482594-20240103.png)

- **位置** ($\mathbf{x}$)：ある時点でのオブジェクトの空間内の位置を示します。
- **速度** ( $\mathbf{v}$)：位置の時間に対する変化率、$\mathbf{v} = \frac{d\mathbf{x}}{dt}$
- **加速度** ($\mathbf{a}$)：速度の時間に対する変化率、 $\mathbf{a} = \frac{d\mathbf{v}}{dt}$

これによる位置を求める公式は、

$$
x = \int \mathbf{a}dt + \mathbf{v}t=\frac{1}{2}\mathbf{a}t^2+\mathbf{v}t
$$

加速度の積分が速度の変位になっていて、それと初期速度での変位を足すと最終的な変位$x$が求まる。

![](https://storage.googleapis.com/zenn-user-upload/c78087451c3a-20240103.png)

こちらは放物線の図で、初期の速度ベクトルと重力による加速度ベクトルの合成により計算できます。こういったベクトルの力の合成は、三角関数を使って各軸に分解してから合成することによって求まります。これは三次元も同様になります。

これらの基本式は、CGにおけるオブジェクトの動きをシミュレートする際の基礎となります。たとえばパーティクルシステムなどは、これらの基本的な運動方程式で表現できます。


## 力・仕事・エネルギー

高校物理で最も有名な公式である運動方程式は、力$F$は質量$m$と加速度$a$に比例するというシンプルな式です。

$$
F = ma
$$

まず静止した物体の釣り合いについて図を書いてみます。

![](https://storage.googleapis.com/zenn-user-upload/45629d4bb2a7-20240103.png)

このように物体が静止しているとき、物体は動いていないですが常に力がかかっていて、その力は釣り合っています。

次に物体が動くときの力について図を書いてみます。

![](https://storage.googleapis.com/zenn-user-upload/61d4dc694103-20240101.png)

物体が動くとき、速さに比例する力（動摩擦力や空気抵抗）などが加速度としてかかってきます。

このときに運動方程式が成立し、物体が動くときに働く力（この図では$F-f’$）は質量$m$と加速度$a$と比例するということになります。

CGでは物理シュミレーションをする際に、物体の摩擦や弾性を計算する際に必要となってくる基礎知識になります。

これらの力$F$の時間軸での積分したものを**仕事**$W$と呼びます。また、物体が持っている仕事をする能力を**エネルギー**$K$と呼びます。このエネルギー$K$は有名なエネルギー保存則に繋がったりしてきます。

## 剛体（Rigid Body）

剛体とは変形しない物体で、物理シュミレーションにおいては比較的計算しやすく基本となるものです。

### 重心と作用の関係
剛体とは変形しない物体で、物理シュミレーションにおいては比較的計算しやすく基本となるものです。CGソフトを触っているとこのRigid BodyとCollisionという単語がよく出てくるかとおもいますが、この剛体という単元がそれにあたります。

剛体は以下の３つの単元にわかれます。

- **重心と作用**：剛体の運動の分解
- **慣性モーメント**：回転のしにくさに関する力
- **運動方程式**：回転の力の計算

### **重心と作用の関係**

剛体には質点となる重心があり、その重心と力がかかる作用線との関係で物体の移動と回転を求めることができます。

剛体の運動は、物体の**重心の移動**と、物体の重心を通り方**向を持つ軸**を中心とした**回転**で表すことができる。

![](https://storage.googleapis.com/zenn-user-upload/e50a8aa70092-20240101.png)

高校物理だと2次元のちからの釣り合いなどが出題されるが、3次元に加えて運動を扱うCGだとより一層複雑になってくる。

### 慣性モーメント

慣性モーメントは物体の回しにくさを表したものです。

慣性モーメント$I$は回転軸からの半径$r$、質量$m$としたとき以下のような式で現わされる

$$
I = \int r^2dm
$$

また、角運動量という回転の力を表すものが単位があり、角速度$\omega$としたとき、力のモーメント$I$との関係は、

$$
L = I\omega
$$

と表される、これは回転角における運動方程式$F=ma$と同様のことを表している。つまり力のモーメントとは回転における質量みたいなものってことです。

そしてこれらを簡単にまとめると、回転軸から遠くて重いものは回すのに必要な力が大きくなるということです。

### オイラーの運動方程式

オイラーの運動方程式は、剛体の角速度ベクトルの時間変化を記述する常微分方程式で、剛体の回転運動を支配しています。

剛体に対する回転の運動方程式は，角運動量 $L$，トルク $N$ とする。また、角運動量は$L=I\omega$なので、

$$
N = \frac{dL}{dt} = \frac{d}{dt}(I\omega)
$$

トルク$N$とは、回転における仕事またはエネルギーの表現です。

これを拡大して、3次元空間で考えたとき、角速度ベクトル$\omega$、慣性テンソル$I$、トルクベクトル$N$はこう表される。

$$
N = I\dot\omega + ω × Iω
$$

この式を**オイラーの運動方程式**といいます（$\dot\omega$は剛体での角速度の時間微分です。）

## 弾性体（Elastic Body）

弾性体とは変形ができ、元の形状に戻ろうとする力が働く性質の物体です。物理では小さなバネの集合として近似的に計算できます。

弾性体を計算するためには以下の基礎知識が必要です。

- **ばね（フックの法則）**
- **応力とひずみ**

### ばね

**フックの法則**というシンプルな定理があるので、軽く説明します。

$$
F = -kx
$$

ばねにかかる力$F$はバネ係数$k$と変位$x$に正比例する。

つまりバネが伸びれば伸びるほど、かかる力が強くなっていくということです。

### ひずみテンソル

**ひずみ**$\epsilon$とは、外部から力が加わったときに変形する程度のことです。また、**応力**$\sigma$とは単位面積にかかる力のことです。パスカル（Pa）という単位でよくでてきます。

まずは応力とひずみの公式から

![](https://storage.googleapis.com/zenn-user-upload/a7f0ad70e953-20240101.png)

$$
変位 u = x_0 - x_1\\
弾性力 f = k(u_b - u_a)　フックの公式\\
ひずみ \epsilon = \frac{u_b - u_a}{x_b - x_a} = \frac{変形量}{初期長さ}\\
応力\sigma = \frac{k(x_b-x_a)}{S}\epsilon = \frac{力}{面積}ひずみ
$$

これを三次元で表現すると、歪みテンソルとして表現される

$$
\sigma = \begin{pmatrix}
\sigma_{xx}& \sigma_{xy} &\sigma_{xz} \\
\sigma_{yx}& \sigma_{yy}& \sigma_{yz} \\
\sigma_{zx}& \sigma_{xy}& \sigma_{zz} 
\end{pmatrix}
$$

:::message
💡 テンソルという概念が初出していますが、大学数学の分野で、ベクトルや行列の上位概念みたいなものです。三次元に対してひずみを適応するためのもので、主にせん断と伸縮の合成を表すものです。
:::

![](https://storage.googleapis.com/zenn-user-upload/a453bfeecb81-20240101.png)

立方体の表面の各点におけるひずみをふくめた応力を行列として計算できる。

これらのひずみテンソルは、伸縮ひずみ行列（ScaleMatrix）とせん断ひずみ行列（ShearMatrix）の合成になっている。

これらの考え方を元に、垂直方向の弾性係数**ヤング率**$E$とせん断方向の係数**ポワソン比** $\nu$などの係数を元にひずみテンソルの各成分を各成分で微分し、微小立方体の変化量として記述することによりひずみが計算できる。

# 流体（Fluid）

流体力学は、流体（液体やガス）の動きを研究する物理学の一分野です。流体の動きをモデル化しシミュレートするために、主に「**格子法**」と「**粒子法**」という二つの異なるアプローチが用いられます。

## 格子法（グリッドベース法）：

この方法では、流体を含む空間を小さな格子（グリッド）に分割し、各格子点で流体の速度、圧力、密度などの物理量を計算します。
![](https://storage.googleapis.com/zenn-user-upload/eae349db069f-20240105.png)

### **ナビエ・ストークス方程式**

流体の運動を記述するためによく用いられる基本方程式です。

$$
\frac{∂\vec u}{∂t} =-(\vec{u} \cdot ∇ )\vec{u}−\frac{1}{\rho}∇p+μ∇^2\vec{u} + \vec f 
$$

時間微分された移動量$∂\vec{u}$は、圧力$\rho$、密度$p$、粘性係数$\mu$、$\vec{u}$、外力$\vec{f}$の関係で表されます。

### 離散化・差分法

以上の方程式をコンピューターで計算するために、**離散化**という作業が必要です。

時間や空間を細かく区切って**飛び飛びの値（離散値）** にすることです。つまり格子法というのは、空間を離散化するということを表しています。

また、それをコンピューターが計算できるように**いろいろ**やります。

これらをまとめて**差分法**といいます。

## 粒子法（パーティクルベース法）：

流体を無数の小さな粒子としてモデル化し、各粒子の動きを追跡する方法です。粒子は流体の一部を表し、それぞれが独立して動きます。

![](https://storage.googleapis.com/zenn-user-upload/913c468a80c3-20240105.png)

格子法でもつかった**ナビエ・ストークス方程式**を少しアレンジしてつかいます。流れを表す移流項がなくなっています。

$$
\frac{∂\vec u}{∂t} =−\frac{1}{\rho}∇p+μ∇^2\vec{u} + \vec f 
$$

### **SPH法（Smoothed Particle Hydrodynamics）**

粒子法を計算するアルゴリズムは２つあります

- SPH法（Smoothed Particle Hydrodynamics）：圧縮性流体を扱います
- MPS法（Moving Particle Semi-Implicit method）：非圧縮流体を扱います。

CGでは計算コストの低いSPH法がよく使われます。


## 波・光
物理学における波は、エネルギーの伝達方法の一つとして重要な役割を果たします。

- **振幅 (Amplitude)**: 波の最高点と平均位置との間の距離。振幅は波のエネルギーの大きさを示します。
- **波長 (Wavelength)**: 連続する波の山（または谷）間の距離。波長は波がどれだけの空間を占めるかを示します。
- **周波数 (Frequency)**: 単位時間あたりに通過する波の数で、ヘルツ（Hz）で表されます

![](https://storage.googleapis.com/zenn-user-upload/4b0f53e03c95-20240105.png)

CGで波の知識は主に光の計算をするときに使います。最終出力は色のデータなので、色の計算をするうえで波の知識は必要不可欠です。

## 光の反射・屈折(Reflection, Refraction )

CGにおける物質表面の質感を表現する際、光の性質を擬似的に計算することでその物質の表面の質感を画面に表現できます。

一般的に鏡面反射と呼ばれる現象は、入射角と反射角が同じになる現象のことです。また表面が凸凹している物質の場合は光が**乱反射**します。

![](https://storage.googleapis.com/zenn-user-upload/f7484d9d832e-20240105.png)

また、半透明の物質が物質をすり抜けるときには、光の進む速度が物質の性質により変化するので

入射角を $i$ 、屈折角を $r$ 、媒質1における波の速さを $v_1$ 、媒質2における波の速さを $v_2$ としますと、これらの間には以下の関係があります。

$$
\frac{\sin i}{\sin r} = \frac{v_1}{v_2}
$$

入射角の$sin$と屈折角の$sin$の比が、波の速さの比になるのです。この関係を**屈折の法則**または**スネルの法則**といいます。

なぜ光の進む速度が屈折率に影響するかというのは、**ホイヘンスの原理**で説明されます。

波をたくさんの点と表すと、その点から同心円状に出る波の共通の接線を新しい波として表現すると説明はできるのですが、動画などを見るほうが理解が早いかと思います。

[2018-2-024_ホイヘンスの原理と屈折（アニメーション）](https://www.youtube.com/watch?v=GwFkLr7SvcM)

## 散乱(Scattering)

空気中や物質の内部には、光を周囲に拡散させるような細かい粒子がたくさんあります。CGにおける散乱モデルで有名なものをとりあげます。

- **レイリー散乱**：空や夕焼けの色合いを説明できる
- **ミー散乱**：雲や霧などの白っぽい煙状の現象を説明できる。
- **表面下散乱**：肌やゴムなどの半透明な物体の散乱

![](https://storage.googleapis.com/zenn-user-upload/9224e34403b6-20240105.png)

### レイリー散乱（Rayleigh scattering）

粒子のサイズが波長より小さい場合の散乱になります。空の色が晴天時には青く、日没時には赤く見えるのはレイリー散乱によって説明できます。

レイリー散乱係数$\beta_R^s$は、高度$h$と波長$\lambda$の関係によってこのような式で表されます。（分子の密度N≒$2.7\times10^{25}/m^3$、大気の屈折率n≒1.0003、自然対数の底*e*≒2.71）

$$
\beta_R^s(h,\lambda) = \frac{8\pi(n^2-1)^2 }{3N\lambda^4}e^{-\frac{h}{H_R}}
$$

このように散乱係数は波長の4乗に反比例するということらしい。

シンプルに表現すると放射輝度$I$は、入射輝度$I_0$と波長$\lambda^4$と反比例するという式になる。

$$
I(\lambda) = I_0\frac{1}{\lambda^4}\frac{(n^2-1)^2}{N}
$$

つまり、波長が短い青い光は放射輝度が高くなる→よく空気中で拡散する、波長が長い赤い光は放射輝度が低くなる→空気中をすり抜ける。

### ミー散乱（Mie Scattering）

空気中の粒子が光の波長より大きいときに起きる散乱現象で、一般的には、雲や霧などの自然現象にみられる。

CGにおいてはレイトレーシングによりボリュームレンダリングや、Fogなどで擬似的に計算されます。ボリュームレンダリングについては別稿で解説する予定です。

散乱現象とボリュームレンダリング方程式についてより深くまとまっている記事があったので、リンクしておきます。

[散乱理論とレンダリング方程式](https://k-ishiyama.github.io/posts/202012_advent_calendar/)

### 表面下散乱（Subsurface Scattering）

光が半透過物質を通った際に、表面化で散乱が起きたあとに表面から出ていく現象のことです。
一般的な現象としては、人の肌やゴムなどに光を当てたときの物質内で光が拡散しているような見た目になる現象です。
こちらは物理用語というよりCG用語なので、こういう現象があるんだなくらいに思ってるといいかもです。

![](https://storage.googleapis.com/zenn-user-upload/84d72df5f9a6-20240105.png)

[An Introduction To Real-Time Subsurface Scattering](https://therealmjp.github.io/posts/sss-intro/)


# TBD

- フーリエ解析
- 拘束
- レンズとカメラ
- レンズとカメラ